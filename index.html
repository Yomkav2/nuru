<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nuru</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
    :root{
        --bg:#010105;            /* очень тёмный фон */
        --panel:#07060a;
        --card:#07060b;
        --muted:#9a98a6;
        --accent:#8b5cf6;        /* фиолетовый акцент */
        --accent-2:#2dd4bf;
    }

    html,body{height:100%;margin:0;background:var(--bg);color:#eef0f7;font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial;-webkit-font-smoothing:antialiased;}
    header{
        position:sticky;top:0;z-index:30;
        display:flex;align-items:center;gap:14px;padding:12px 18px;
        background: rgba(255,255,255,0.006);
        border-bottom:1px solid rgba(255,255,255,0.02);
        backdrop-filter: blur(4px);
    }

    .brand{display:flex;align-items:center;gap:12px;cursor:pointer;user-select:none;}
    /* сильно затемнённый квадрат с N */
    .logo{
        width:44px;height:44px;border-radius:8px;
        background: linear-gradient(180deg,#03030a,#0a0910); /* очень тёмный */
        display:flex;align-items:center;justify-content:center;font-weight:700;color:#cfc7ff;
        box-shadow:none;border:1px solid rgba(255,255,255,0.02);
    }
    h1{margin:0;font-size:1.05rem;color:var(--accent);letter-spacing:0.3px;}

    main{max-width:1100px;margin:22px auto;padding:16px;box-sizing:border-box;}

    .controls{display:flex;gap:14px;margin-bottom:18px;align-items:center;}
    .search{flex:1;display:flex;gap:10px;align-items:center;padding:10px 12px;border-radius:12px;background:var(--panel);border:1px solid rgba(255,255,255,0.02);}
    .search input{background:transparent;border:0;outline:0;color:inherit;font-size:1rem;width:100%;}
    .btn{background:linear-gradient(180deg,var(--accent),#6f42f5);border:0;padding:10px 14px;border-radius:10px;color:white;font-weight:600;cursor:pointer;box-shadow:none;}

    .post-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px;}
    .post-card{
        display:block; /* ссылка-обёртка */
        background:var(--card);
        border-radius:12px;padding:14px;border:1px solid rgba(255,255,255,0.02);
        min-height:110px;box-sizing:border-box;color:inherit;text-decoration:none;
    }
    /* убрать любые hover-анимации */
    .post-card:hover{transform:none;box-shadow:none;}
    .post-card h3{margin:0 0 8px 0;color:#fff;font-size:1.03rem;}
    .post-card p{margin:0;color:var(--muted);font-size:0.92rem;line-height:1.35;}
    .tag{display:inline-block;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.01);color:var(--muted);font-size:0.8rem;margin-top:10px;}

    .muted-center{text-align:center;color:var(--muted);padding:24px 10px;}

    footer{display:none;} /* убрана подпись */

    /* убрать все анимации переходы */
    * { transition: none !important; animation: none !important; }

    @media (max-width:980px){
        .post-grid{grid-template-columns:repeat(auto-fill,minmax(200px,1fr));}
    }
</style>
</head>
<body>
<header>
    <div class="brand" onclick="location.href='index.html'">
        <div class="logo">N</div>
        <h1>Nuru</h1>
    </div>
</header>

<main>
    <div class="controls">
        <div class="search">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="opacity:.7"><path d="M21 21l-4.35-4.35" stroke="#fff" stroke-opacity="0.7" stroke-width="1.6" stroke-linecap="round"></path><circle cx="11" cy="11" r="5" stroke="#fff" stroke-opacity="0.6" stroke-width="1.6"></circle></svg>
            <input id="search-bar" placeholder="Поиск по заголовку или описанию" />
        </div>
    </div>

    <section>
        <div id="post-container" class="post-grid"></div>
        <div id="empty" class="muted-center" style="display:none;">Ничего не найдено. Попробуйте другой запрос.</div>
    </section>
</main>

<script src="posts.js"></script>
<script>
if (typeof posts === 'undefined') {
    document.getElementById('post-container').innerHTML = '<div class="muted-center">Файл posts.js не найден или содержит ошибку.</div>';
    throw new Error('posts.js not found');
}

const allPosts = posts.map((p,i) => ({
    title: String(p.title || 'Без названия'),
    description: String(p.description || ''),
    id: i + 1,
    tags: Array.isArray(p.tags) ? p.tags : []
}));

const container = document.getElementById('post-container');
const emptyBox = document.getElementById('empty');
const searchBar = document.getElementById('search-bar');

function escapeHtml(s){ return s.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
function truncate(s,n){ return s.length>n? s.slice(0,n-1)+'…' : s; }

function render(list){
    container.innerHTML='';
    if (!list.length) { emptyBox.style.display='block'; return; }
    emptyBox.style.display='none';
    list.forEach((post) => {
        const card = document.createElement('a');
        card.className = 'post-card';
        card.href = `post.html?id=${post.id}`;
        card.innerHTML = `<div><h3>${escapeHtml(post.title)}</h3><p>${escapeHtml(truncate(post.description,120))}</p></div><div class="tag small">${post.tags.join(' · ') || 'script'}</div>`;
        container.appendChild(card);
    });
}

let timer = null;
searchBar.addEventListener('input', (e) => {
    clearTimeout(timer);
    timer = setTimeout(() => {
        const q = e.target.value.trim().toLowerCase();
        const filtered = allPosts.filter(p =>
            p.title.toLowerCase().includes(q) ||
            p.description.toLowerCase().includes(q) ||
            p.tags.join(' ').toLowerCase().includes(q)
        );
        render(filtered);
    }, 120);
});

render(allPosts);
</script>
</body>
</html>
